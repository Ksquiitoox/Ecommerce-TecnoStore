<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito - TecnoStore</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <nav id="navbar"></nav>
    <h2 style="text-align:center; margin-top:20px;">Tu Carrito</h2>
    <section id="cart-container" class="products-container"></section>

    <script src="js/navbar.js"></script>
    <script type="module">
        const container = document.getElementById('cart-container');

        function renderCart() {
            container.innerHTML = '';
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            if(cart.length === 0) {
                container.innerHTML = '<p style="text-align:center;">Tu carrito está vacío</p>';
                return;
            }

            cart.forEach((item, index) => {
                const card = document.createElement('div');
                card.classList.add('product-card');
                card.innerHTML = `
                    <img src="${item.image}" alt="${item.title}" class="product-img">
                    <h3 class="product-title">${item.title}</h3>
                    <p>Precio unitario: $${item.price.toLocaleString()}</p>
                    <div class="quantity-selector">
                        <button class="qty-btn decrease">-</button>
                        <span class="qty">${item.quantity}</span>
                        <button class="qty-btn increase">+</button>
                    </div>
                    <p>Subtotal: $<span class="subtotal">${(item.price*item.quantity).toLocaleString()}</span></p>
                    <button class="btn-product remove-item">Eliminar</button>
                `;
                container.appendChild(card);

                const decreaseBtn = card.querySelector('.decrease');
                const increaseBtn = card.querySelector('.increase');
                const qtySpan = card.querySelector('.qty');
                const subtotalSpan = card.querySelector('.subtotal');
                const removeBtn = card.querySelector('.remove-item');

                decreaseBtn.addEventListener('click', () => {
                    if(item.quantity>1) item.quantity--;
                    qtySpan.textContent = item.quantity;
                    subtotalSpan.textContent = (item.price*item.quantity).toLocaleString();
                    localStorage.setItem('cart', JSON.stringify(cart));
                    window.dispatchEvent(new Event('cartUpdated'));
                });

                increaseBtn.addEventListener('click', () => {
                    item.quantity++;
                    qtySpan.textContent = item.quantity;
                    subtotalSpan.textContent = (item.price*item.quantity).toLocaleString();
                    localStorage.setItem('cart', JSON.stringify(cart));
                    window.dispatchEvent(new Event('cartUpdated'));
                });

                removeBtn.addEventListener('click', () => {
                    cart.splice(index, 1);
                    localStorage.setItem('cart', JSON.stringify(cart));
                    renderCart();
                    window.dispatchEvent(new Event('cartUpdated'));
                });
            });
        }

        renderCart();
    </script>
    <section class="footer">
    <p>© 2025 TecnoStore — Todos los derechos reservados</p>
  </section>
</body>
</html>